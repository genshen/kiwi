# kiwi: A framework for parallel.
# author: genshen <genshenchu@gmail.com>
# pkg version 0.2.0-beta

version: 1

args:


packages:
  git:
    googletest:
      path: https://github.com/google/googletest.git
      tag: release-1.8.1
      build:
        - RUN {{.CACHE}} cmake {{.SRC_DIR}} -DCMAKE_INSTALL_PREFIX={{.PKG_DIR}}; make -j {{.CORES}}; make install
      cmake_lib: |
        find_package(GTest PATHS {{.CMAKE_VENDOR_PATH_PKG}})
    fmt:
      path: https://github.com/fmtlib/fmt.git
      tag: 5.3.0
      build:
      - RUN {{.CACHE}} cmake {{.SRC_DIR}} -DCMAKE_INSTALL_PREFIX={{.PKG_DIR}}; make -j {{.CORES}}; make install
      cmake_lib: |
        find_package(fmt PATHS {{.CMAKE_VENDOR_PATH_PKG}})

  files:
    catch2:
      path: https://raw.githubusercontent.com/CatchOrg/Catch2/v2.2.2/single_include
      files:
        catch.hpp: catch2.hpp
      build:
      - CP catch2.hpp {{.INCLUDE}}/catch2.hpp
    cpptoml:
      path: https://raw.githubusercontent.com/skystrife/cpptoml/v0.1.1/include
      files:
        cpptoml.h: toml.hpp
      build:
      - CP toml.hpp {{.INCLUDE}}/toml.hpp

build:
  linux:
  - RUN {{.CACHE}} cmake {{.SRC_DIR}} -DCMAKE_INSTALL_PREFIX={{.PKG_DIR}}; make -j {{.CORES}}; make install
  darwin:
  - RUN {{.CACHE}} cmake {{.SRC_DIR}} -DCMAKE_INSTALL_PREFIX={{.PKG_DIR}}; make -j {{.CORES}}; make install

cmake_lib: |
  find_package(kiwi PATHS {{.CMAKE_VENDOR_PATH_PKG}})
